!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Mixapp=e()}}(function(){return function e(t,n,r){function o(s,u){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return o(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=null,u=null;"undefined"==typeof XMLHttpRequest&&(s=e("https"),u=e("http"));var a=function(){function e(t){r(this,e),this.port=t.port||443,this.host=t.host||"api.mixapp.io",this.headers={},this.token=t.token||"",this.timeout=t.timeout||1e4}return i(e,[{key:"get",value:function(e,t,n){return this._request("get",e,t,null,n)}},{key:"post",value:function(e,t,n,r){return this._request("POST",e,t,n,r)}},{key:"del",value:function(e,t,n){return this._request("DELETE",e,t,null,n)}},{key:"setToken",value:function(e){this.token=e,this.setHeader("X-Auth-Token",e)}},{key:"setHeader",value:function(e,t){this.headers[e]=t}},{key:"setTimeout",value:function(){}},{key:"_node_request",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments[4];a=o({},this.headers,a),"post"===e.toLowerCase()&&(a["Content-Type"]="application/json");var c="";if("post"===e.toLowerCase()||"get"===e.toLowerCase()||"delete"===e.toLowerCase()){var l=[];for(var p in n)l.push(p+"="+n[p]);c=l.join("&")}var f=new Promise(function(n,o){var l=443===r.port?s:u,p=l.request({method:e,port:r.port,path:t+"?"+c,host:r.host,headers:a},function(e){var t="";return 200!==e.statusCode&&201!==e.statusCode?o({error_code:e.statusCode,error_message:e.responseText||"Invalid statusCode"}):(e.on("data",function(e){t+=e.toString()}),e.on("error",function(t){return o({error_code:e.statusCode,error_message:t.message})}),void e.on("end",function(){return n(t)}))});p.on("aborted",function(){return o({error_code:504,error_message:"Request has been aborted by the server"})}),p.on("abort",function(){return o({error_code:418,error_message:"Request has been aborted by the client"})}),p.on("error",function(e){return o({error_code:422,error_message:e.message})}),p.setTimeout(r.timeout,function(){p.abort()}),"post"===e.toLowerCase()&&p.write(JSON.stringify(i)),p.end()}).then(function(e){return JSON.parse(e)}).then(function(e){return e.error_code?Promise.reject(e):e.error?Promise.reject({error_code:500,error_message:e.error_description}):e});return f}},{key:"_ajax",value:function(e,t,n,r,o){var i=this,s=new Promise(function(s,u){var a="";if("post"===e.toLowerCase()||"get"===e.toLowerCase()||"delete"===e.toLowerCase()){var c=[];for(var l in n)c.push(l+"="+n[l]);a=c.join("&")}var p=443==i.port?"https":"http",f=p+"://"+i.host+":"+i.port+t+"?"+a,h=new XMLHttpRequest;h.timeout=i.timeout,h.open(e,f,!0);for(var v in i.headers)h.setRequestHeader(v,i.headers[v]);for(var k in o)h.setRequestHeader(k,o[k]);"post"===e.toLowerCase()&&h.setRequestHeader("Content-Type","application/json"),h.onreadystatechange=function(){if(4==h.readyState)return 200!=h.status&&201!=h.status?u({error_code:h.status,error_message:h.responseText||"Invalid statusCode"}):void s(h.responseText)},"post"===e.toLowerCase()?h.send(JSON.stringify(r)):h.send()}).then(function(e){return JSON.parse(e)}).then(function(e){return e.error_code?Promise.reject(e):e.error?Promise.reject({error_code:500,error_message:e.error_description}):e});return s}},{key:"_request",value:function(e,t,n,r,o){return"undefined"!=typeof XMLHttpRequest?this._ajax(e,t,n,r,o):this._node_request(e,t,n,r,o)}}]),e}();n["default"]=a},{http:void 0,https:void 0}],2:[function(e,t,n){"use strict";var r=e("./service"),o={Service:r.Service};t.exports=o},{"./service":4}],3:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n.Process=function(){function e(t,n,o){r(this,e);for(var i in t)this[i]=t[i];Object.defineProperty(this,"_workplace",{enumerable:!1,value:n}),Object.defineProperty(this,"_client",{enumerable:!1,value:o})}return o(e,[{key:"fetch",value:function(){var e=this;return this._client.get("/v1/workplaces/"+this._workplace+"/processes/"+this.id).then(function(t){for(var n in t.result)e[n]=t.result[n];return e})}},{key:"getContext",value:function(e,t){return this._client.get("/v1/workplaces/"+this._workplace+"/processes/"+this.id+"/context",{skip:e,limit:t})}},{key:"getLogs",value:function(e,t){return this._client.get("/v1/workplaces/"+this._workplace+"/processes/"+this.id+"/logs",{skip:e,limit:t})}},{key:"flushLogs",value:function(){return this._client.del("/v1/workplaces/"+this._workplace+"/processes/"+this.id+"/logs",{})}},{key:"update",value:function(e){var t=this;return this._client.post("/v1/workplaces/"+this._workplace+"/processes/"+this.id,{},e).then(function(e){for(var n in e.result)t[n]=e.result[n];return t})}},{key:"clone",value:function(e){return this._client.post("/v1/workplaces/"+this._workplace+"/processes/"+this.id+"/clone",{},e)}},{key:"remove",value:function(){return this._client.del("/v1/workplaces/"+this._workplace+"/processes/"+this.id)}},{key:"start",value:function(e){return this._client.post("/v1/workplaces/"+this._workplace+"/processes/"+this.id+"/start",{},e)}},{key:"stop",value:function(){return this._client.post("/v1/workplaces/"+this._workplace+"/processes/"+this.id+"/stop",{})}},{key:"createConnector",value:function(e){return this._client.post("/v1/workplaces/"+this._workplace+"/processes/"+this.id+"/connectors",{},e).then(function(e){return e.result})}},{key:"updateConnector",value:function(e,t){return this._client.post("/v1/workplaces/"+this._workplace+"/processes/"+this.id+"/connectors/"+e,{},t).then(function(e){return e.result})}},{key:"moveConnector",value:function(e,t,n){return this._client.post("/v1/workplaces/"+this._workplace+"/processes/"+this.id+"/connectors/"+e+"/move",{},{positionX:t,positionY:n})}},{key:"removeConnector",value:function(e){return this._client.del("/v1/workplaces/"+this._workplace+"/processes/"+this.id+"/connectors/"+e,{})}},{key:"setRelation",value:function(e,t){return this._client.post("/v1/workplaces/"+this._workplace+"/processes/"+this.id+"/connectors/"+e+"/relation/"+t,{})}},{key:"setRelationName",value:function(e,t,n){return this._client.post("/v1/workplaces/"+this._workplace+"/processes/"+this.id+"/connectors/"+e+"/relation/"+t+"/"+n,{})}},{key:"unsetRelation",value:function(e,t){return this._client.del("/v1/workplaces/"+this._workplace+"/processes/"+this.id+"/connectors/"+e+"/relation/"+t,{})}}]),e}()},{}],4:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.Service=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./client"),u=r(s),a=e("./workplace");n.Service=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),Object.defineProperty(this,"_client",{enumerable:!1,value:new u["default"](n)}),this.workplaces={getList:function(e,n){return t._client.get("/v1/workplaces",{skip:e,limit:n}).then(function(e){return e.items=e.items.map(function(e){return new a.Workplace(e,t._client)}),e})},get:function(e){return t._client.get("/v1/workplaces/"+e).then(function(e){return new a.Workplace(e.result,t._client)})},create:function(e){return t._client.post("/v1/workplaces",{},e).then(function(e){return new a.Workplace(e.result,t._client)})}}}return i(e,[{key:"get",value:function(){return this._client.get("/v1",null)}},{key:"getPlans",value:function(){return this._client.get("/v1/plans",null).then(function(e){return e.result})}},{key:"getOrders",value:function(e,t){return this._client.get("/v1/orders",{skip:e,limit:t})}},{key:"signIn",value:function(e,t){var n=this;return this._client.post("/v1/signin",{},{email:e,password:t}).then(function(e){return n._client.setToken(e.token),e})}},{key:"signUp",value:function(e){var t=this;return this._client.post("/v1/signup",{},e).then(function(e){return t._client.setToken(e.token),e})}},{key:"update",value:function(e){return this._client.post("/v1/update",{},e)}},{key:"restore",value:function(e){return this._client.post("/v1/repair",{},{email:e})}},{key:"confirmRestore",value:function(e,t){return this._client.post("/v1/repair/"+e,{},{password:t})}}]),e}()},{"./client":1,"./workplace":6}],5:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n.Storage=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1],o=arguments[2];r(this,e);for(var i in t)this[i]=t[i];Object.defineProperty(this,"_ACL",{enumerable:!1,value:[]}),Object.defineProperty(this,"_workplace",{enumerable:!1,value:n}),Object.defineProperty(this,"_client",{enumerable:!1,value:o})}return o(e,[{key:"fetch",value:function(){var e=this;return this._client.get("/v1/workplaces/"+this._workplace+"/storages/"+this.name).then(function(t){for(var n in t.result)e[n]=t.result[n];return e})}},{key:"update",value:function(e){var t=this;return this._client.post("/v1/workplaces/"+this._workplace+"/storages/"+this.name,{},e).then(function(e){for(var n in e.result)t[n]=e.result[n];return t})}},{key:"remove",value:function(){return this._client.del("/v1/workplaces/"+this._workplace+"/storages/"+this.name)}},{key:"getIndexes",value:function(){return this._client.get("/v1/workplaces/"+this._workplace+"/storages/"+this.name+"/indexes")}},{key:"createIndex",value:function(e){return this._client.post("/v1/workplaces/"+this._workplace+"/storages/"+this.name+"/indexes",{},e)}},{key:"removeIndex",value:function(e){return e=e.toLowerCase(),this._client.del("/v1/workplaces/"+this._workplace+"/storages/"+this.name+"/indexes/"+e)}},{key:"setACL",value:function(e){if(!(e instanceof Array))throw new Error("acl must be an array");this._ACL=e}},{key:"getDocuments",value:function(e){var t={"X-Auth-Keys":this._ACL.join(",")};return this._client.post("/v1/workplaces/"+this._workplace+"/storages/"+this.name+"/read",{},e,t).then(function(e){return e.result})}},{key:"createDocument",value:function(e){var t={"X-Auth-Keys":this._ACL.join(",")};return this._client.post("/v1/workplaces/"+this._workplace+"/storages/"+this.name+"/create",{},e,t).then(function(e){return e.result})}},{key:"updateDocuments",value:function(e){var t={"X-Auth-Keys":this._ACL.join(",")};return this._client.post("/v1/workplaces/"+this._workplace+"/storages/"+this.name+"/update",{},e,t).then(function(e){return e.result})}},{key:"removeDocuments",value:function(e){var t={"X-Auth-Keys":this._ACL.join(",")};return this._client.post("/v1/workplaces/"+this._workplace+"/storages/"+this.name+"/delete",{},e,t).then(function(e){return e.result})}},{key:"countDocuments",value:function(e){var t={"X-Auth-Keys":this._ACL.join(",")};return this._client.post("/v1/workplaces/"+this._workplace+"/storages/"+this.name+"/count",{},e,t)}}]),e}()},{}],6:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.Workplace=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./storage"),u=e("./process");n.Workplace=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments[1];r(this,e),Object.defineProperty(this,"_client",{enumerable:!1,value:o}),Object.defineProperty(this,"storages",{enumerable:!1,value:{getAll:function(){return t._client.get("/v1/workplaces/"+t.name+"/storages").then(function(e){return e.result.map(function(e){return new s.Storage(e,t.name,t._client)})})},create:function(e){return t._client.post("/v1/workplaces/"+t.name+"/storages",{},e).then(function(e){return new s.Storage(e.result,t.name,t._client)})},get:function(e){return t._client.get("/v1/workplaces/"+t.name+"/storages/"+e).then(function(e){return new s.Storage(e.result,t.name,t._client)})}}}),Object.defineProperty(this,"processes",{enumerable:!1,value:{search:function(e){return t._client.get("/v1/workplaces/"+t.name+"/processes",e).then(function(e){return{total:e.total,items:e.items.map(function(e){return new u.Process(e,t.name,t._client)})}})},get:function(e){return t._client.get("/v1/workplaces/"+t.name+"/processes/"+e).then(function(e){return new u.Process(e.result,t.name,t._client)})},create:function(e){return t._client.post("/v1/workplaces/"+t.name+"/processes",{},e).then(function(e){return new u.Process(e.result,t.name,t._client)})}}}),Object.defineProperty(this,"marketplace",{enumerable:!1,value:{getConnectors:function(e,n){return t._client.get("/v1/workplaces/"+t.name+"/marketplace/connectors",{skip:e,limit:n})},installConnector:function(e){return t._client.post("/v1/workplaces/"+t.name+"/marketplace/connectors/"+e+"/install",{},{})},getProcesses:function(e,n){return t._client.get("/v1/workplaces/"+t.name+"/marketplace/processes",{skip:e,limit:n})},installProcess:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t._client.post("/v1/workplaces/"+t.name+"/marketplace/processes/"+e+"/install",{},n)}}}),Object.defineProperty(this,"settings",{enumerable:!1,value:{oidc:{get:function(){return t._client.get("/v1/workplaces/"+t.name+"/oidc")},update:function(e){return t._client.post("/v1/workplaces/"+t.name+"/oidc",{},e)},refreshToken:function(){return t._client.post("/v1/workplaces/"+t.name+"/oidc/token",{},{})}}}}),Object.defineProperty(this,"oidc",{enumerable:!1,value:{getClients:function(e){return t._client.get("/oidc/"+t.name+"/registration",{},{Authorization:"Bearer "+e}).then(function(e){return{result:e}})},createClient:function(e,n){return t._client.post("/oidc/"+t.name+"/registration",{},n,{Authorization:"Bearer "+e})},getClient:function(e,n){return t._client.get("/oidc/"+t.name+"/registration",{client_id:n},{Authorization:"Bearer "+e})},updateClient:function(e,n,r){return t._client.post("/oidc/"+t.name+"/registration",{client_id:n},r,{Authorization:"Bearer "+e})},removeClient:function(e,n){return t._client.del("/oidc/"+t.name+"/registration",{client_id:n},{Authorization:"Bearer "+e})}}}),this.name=n.name,this.title=n.title,this.plan=n.plan,this.npm=n.npm}return i(e,[{key:"stats",value:function(){return this._client.get("/v1/workplaces/"+this.name+"/statistics")}},{key:"fetch",value:function(){var e=this;return this._client.get("/v1/workplaces/"+this.name).then(function(t){for(var n in t.result)e[n]=t.result[n];return t})}},{key:"getBills",value:function(e,t){return this._client.get("/v1/workplaces/"+this.name+"/billing",{skip:e,limit:t})}},{key:"buyPlan",value:function(e){return this._client.post("/v1/workplaces/"+this.name+"/billing",{},e).then(function(e){return e.result})}},{key:"getKeys",value:function(){return this._client.get("/v1/workplaces/"+this.name+"/keys")}},{key:"createKey",value:function(e){return this._client.post("/v1/workplaces/"+this.name+"/keys",{},e)}},{key:"updateKey",value:function(e){return this._client.post("/v1/workplaces/"+this.name+"/keys/"+e,{},{})}},{key:"removeKey",value:function(e){return this._client.del("/v1/workplaces/"+this.name+"/keys/"+e)}},{key:"update",value:function(e){var t=this;return e=o({name:this.name},e),this._client.post("/v1/workplaces/"+this.name,{},e).then(function(e){for(var n in e.result)t[n]=e.result[n];return e})}},{key:"remove",value:function(){return this._client.del("/v1/workplaces/"+this.name)}},{key:"getConnectors",value:function(e){return this._client.get("/v1/workplaces/"+this.name+"/connectors",e)}},{key:"uploadConnector",value:function(e){return this._client.post("/v1/workplaces/"+this.name+"/connectors",{},e)}},{key:"removeConnector",value:function(e){return this._client.del("/v1/workplaces/"+this.name+"/connectors/"+e)}},{key:"getConnector",value:function(e){return this._client.get("/v1/workplaces/"+this.name+"/connectors/"+e,{}).then(function(e){return e.result})}}]),e}()},{"./process":3,"./storage":5}]},{},[2])(2)});